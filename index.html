<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>配信 + コメント + 将棋</title>
  <link rel="stylesheet" href="style.css" />
  <!-- 必須: Firebase SDK を下記（例）で追加してください（順序を守ること） -->
  <!--
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>
  -->
</head>
<body>
  <header class="topbar">
    <div class="left">
      <button id="loginBtn" class="controlBtn">ログイン</button>
      <button id="mypageBtn" class="controlBtn" style="display:none">マイページ</button>
      <button id="logoutBtn" class="controlBtn" style="display:none">ログアウト</button>
    </div>
    <div class="center">
      <strong id="gameTitle">配信ページ</strong>
    </div>
    <div class="right">
      <span id="username"></span>
      <img id="avatar" alt="" class="small-avatar" />
      <span id="myPoints" class="points"></span>
    </div>
  </header>

  <main class="container">
    <section class="leftColumn">
      <div id="arrivalBanner" class="arrivalBanner" aria-hidden="true"></div>

      <div id="pollArea" class="poll-area" style="display:none" aria-hidden="true">
        <div id="pollContent" class="poll-content"></div>
        <div id="pollTimer" class="poll-timer" aria-hidden="true"></div>
      </div>

      <div id="commentsContainer" class="commentsContainer">
        <div id="comments" class="comments" aria-live="polite"></div>
      </div>

      <form id="form" class="commentForm" onsubmit="event.preventDefault(); sendComment();">
        <input id="commentInput" type="text" placeholder="コメントを入力..." autocomplete="off" />
        <button id="sendBtn" type="button">送信</button>
      </form>
    </section>

    <aside class="rightColumn">
      <div class="controls">
        <div class="gameControlsTop">
          <button id="pollBtn" class="controlBtn">アンケート作成</button>
          <button id="gameBtn" class="controlBtn">ゲーム</button>
        </div>

        <div id="gameArea" class="gameArea" style="display:none" aria-hidden="true">
          <div class="game-header">
            <div id="gameControls"></div>
            <div id="gameInfo"></div>
          </div>
          <div id="shogiContainer" class="shogiContainer" role="region" aria-label="将棋盤"></div>
        </div>

        <div id="assetPreviewMain" class="assetPreview"></div>
      </div>
    </aside>
  </main>

  <div id="modalBackdrop" class="modal-backdrop" aria-hidden="true"></div>

  <div id="pollModal" class="modal" role="dialog" aria-modal="true" aria-hidden="true" data-modal-id="pollModal">
    <div class="modal-content">
      <button class="close" data-close="pollModal" aria-label="閉じる">✕</button>
      <h3>アンケート作成</h3>
      <input id="pollQuestion" type="text" placeholder="質問を入力" />
      <div id="pollOptionsWrapper" class="pollOptionsWrapper">
        <input class="pollOptionInput" type="text" placeholder="選択肢1" />
        <input class="pollOptionInput" type="text" placeholder="選択肢2" />
      </div>
      <div class="modal-actions">
        <button id="addPollOptionBtn" type="button">選択肢追加</button>
        <button id="createPollBtn" type="button">作成</button>
      </div>
    </div>
  </div>

  <div id="gameModal" class="modal" role="dialog" aria-modal="true" aria-hidden="true" data-modal-id="gameModal">
    <div class="modal-content small">
      <button class="close" data-close="gameModal" aria-label="閉じる">✕</button>
      <h3>ゲーム作成</h3>
      <div class="gameChoice" data-game="shogi" role="button" tabindex="0">将棋</div>
      <label><input id="publicGame" type="checkbox" /> 観戦許可</label>
      <div class="modal-actions"><button id="startGameBtn" type="button">開始</button></div>
    </div>
  </div>

  <div id="loginModal" class="modal" role="dialog" aria-modal="true" aria-hidden="true" data-modal-id="loginModal">
    <div class="modal-content small">
      <button class="close" data-close="loginModal" aria-label="閉じる">✕</button>
      <h3>ログイン / 新規登録</h3>
      <input id="email" type="email" placeholder="メール" />
      <input id="password" type="password" placeholder="パスワード" />
      <div class="modal-actions">
        <button id="signinBtn" type="button">ログイン</button>
        <button id="signupBtn" type="button">登録</button>
      </div>
    </div>
  </div>

  <div id="mypageModal" class="modal" role="dialog" aria-modal="true" aria-hidden="true" data-modal-id="mypageModal">
    <div class="modal-content">
      <button class="close" data-close="mypageModal" aria-label="閉じる">✕</button>
      <h3>マイページ</h3>
      <div id="assetPreview" class="assetPreview"></div>

      <div style="margin-top:12px">
        <label>新しい表示名 <input id="newName" type="text" /></label>
        <button id="updateNameBtn" type="button">更新</button>
      </div>

      <form id="profileUploadForm" style="margin-top:12px" onsubmit="event.preventDefault(); uploadProfileImage();">
        <div>
          <label>プロフィール画像: <input id="profileImageFile" type="file" accept="image/*" /></label>
        </div>
        <div style="margin-top:8px">
          <button id="uploadProfileBtn" type="button">アップロード</button>
        </div>
      </form>
    </div>
  </div>

  <div id="callRequestPopup" class="modal" role="dialog" aria-modal="true" aria-hidden="true" data-modal-id="callRequestPopup">
    <div class="modal-content small">
      <button class="close" data-close="callRequestPopup" aria-label="閉じる">✕</button>
      <div id="callRequestContent"></div>
      <div class="modal-actions">
        <button id="callSendBtn" type="button">送信</button>
        <button id="callCancelBtn" type="button">キャンセル</button>
      </div>
    </div>
  </div>

  <footer class="footer">
    <small>© Example</small>
  </footer>

  <script src="script.js"></script>
</body>
</html>
